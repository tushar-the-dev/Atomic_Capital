<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
  </head>
  <style>
    body {
      margin: 0;
    }

    .atomic-lottie-container {
      height: 200vh;
    }

    .atomic-lottie {
      width: 100%;
      /* height: 100vh; */
      position: sticky;
      top: 0;
    }

    .spacer {
      background-color: lightblue;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
  <body>
    <section class="spacer"></section>
    <section class="atomic-lottie-container">
      <!-- <div class="lottie-container"> -->
      <div class="atomic-lottie"></div>
      <!-- </div> -->
    </section>
    <section class="spacer"></section>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        gsap.registerPlugin(ScrollTrigger);

        const animation = lottie.loadAnimation({
          container: document.querySelector(".atomic-lottie"),
          renderer: "svg",
          loop: false,
          autoplay: false,
          path: "https://raw.githubusercontent.com/tushar-the-dev/Atomic_Capital/refs/heads/main/hosting/Atomic-lottie.json",
        });

        animation.addEventListener("DOMLoaded", () => {
          requestAnimationFrame(() => {
            const atomicLottie = document.querySelector(".atomic-lottie");

            const halfLottieHeight = atomicLottie.offsetHeight * 0.5;

            atomicLottie.style.top = `calc(50% - ${halfLottieHeight}px)`;

            const totalFrames = animation.totalFrames;

            const playhead = { frame: 0 };

            gsap.to(playhead, {
              frame: totalFrames - 1,
              ease: "none",
              scrollTrigger: {
                trigger: ".atomic-lottie-container",
                start: `top 50%`,
                end: `bottom center-=${halfLottieHeight}`,
                scrub: true,
                // pin: ".atomic-lottie",
                // anticipatePin: 1,
                // markers: true,
              },
              onUpdate: () => {
                animation.goToAndStop(playhead.frame, true);
              },
            });

            ScrollTrigger.refresh();
          });
        });
      });
    </script>
  </body>
</html>
